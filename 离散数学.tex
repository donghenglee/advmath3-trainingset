\pagecolor{PageColor}
\
\vfil
\hfil  {\fontsize{50pt}{36pt}\selectfont{组合数学}} \hfil
\vfil
\input{pageborder}
\thispagestyle{empty}
\pagebreak

\begin{center}
  {\fontsize{30pt}{26pt}\selectfont
    \hypertarget{数理逻辑}{数理逻辑} \label{数理逻辑}
  }
\end{center}
\separator
\vspace{1pt}
\nopagecolor
\begin{questions}
    \question 
\end{questions}
\pagebreak

\begin{center}
  {\fontsize{30pt}{26pt}\selectfont
    \hypertarget{排列与组合}{排列与组合} \label{排列与组合}
  }
\end{center}
\separator
\vspace{1pt}
\begin{questions}
    \question 求满足以下条件的三位数的个数:  
    \begin{itemize}
        \item 三个数字各不相同
        \item 数字按递减顺序排列
        \item 其中一个数字是5
    \end{itemize}  
    \begin{solution}
        即先选数字$5$,再从$9$个数字中任选$2$个,所以有 
        \[
        \comb{9}{2}=36
        \]
        个这样的三位数。注意到每组都能唯一地按递减顺序排成一个三位数,而且首位不会是 $0$。
    \end{solution}

    \question 已知 $a,b,c$ 为相异正整数且满足 $abc=2310$,求所有可能相异集合 $\{a,b,c\}$的个数。
    \begin{solution}
        发现$2310 = 2\times 3\times 5\times 7\times 11$,从 $5$ 个因数中,
        \begin{itemize}
            \item 挑 3 个连乘积作为 $a$,剩下 2 个作为 $b,c$,有
            $\comb{5}{3} = 10$种可能。
            \item 挑 2 个连乘积作为 $a$,剩下 3 个再挑 2 个乘积作为 $b$,有 $\comb{5}{2} \cdot \comb{3}{2} = 30$
            种可能。
        \end{itemize}
        故共有$10 + 30 = 40$种可能。
    \end{solution}

    \question $A$ 有一本共有 $2017$ 页的书，页码从 $1$ 到 $2017$。问有多少个页码同时包含至少一个数字 $1$ 和至少一个数字 $9$？例如 $91,1921,191$ 都符合条件。
    \begin{solution}
        情况一:页码为二位数。只有$19,91$满足要求,共2个页码符合要求。

        情况二:页码为三位数。页码中必有数字$1,9$,排列数为$3\cdot 2\cdot 10$,但此时多算了页码$119,191,199,911,919,991,019,091$,故符合要求的页码共有$3\cdot 2\cdot 10-6=52$。

        情况二:页码为三位数。千位必为数字1,而数字9可位于百位、十位或各位,排列数为$3\cdot 10\cdot 10$,但此时多考虑了含两个数字9的页码，共$3\cdot 10$。减去其之后,发现又少算了页码1999。故符合要求的页码共有$3\cdot 10\cdot 10-3\cdot 10+1=271$。

        故共有
        \[
        2+52+271=325
        \]
        个页码符合条件。
    \end{solution}

    \question 设 $N$ 为满足 $x < y < z$ 且
    \[
    xyz = 2^2 \cdot 3^2 \cdot 5^2 \cdot 7^2 \cdot 11^2 \cdot 13^2 \cdot 17^2 \cdot 19^2
    \]
    的正整数三元组 $(x, y, z)$ 的个数。求 $N$。
    \begin{solution}
        忽略$x < y < z$,先计算无序三元组 $(a,b,c)$的个数,使得
        \[
        abc = 2^2 \cdot 3^2 \cdot 5^2 \cdot 7^2 \cdot 11^2 \cdot 13^2 \cdot 17^2 \cdot 19^2
        \]
        每个平方的质因数可以分配给 $a,b,c$ 的方式有 6 种:两个都给 $a$,两个都给 $b$,两个都给 $c$,或者每个数各取一个。共有 8 个平方质因数,因此共有 $6^8$ 种分配方式。

        现考虑$a,b,c$中两个数相等的情况。观察到积$abc$不是完全立方数,所以$a=b=c$不成立。计算恰有一对相等的三元组:以 $a=b$ 为例,每个平方质因数分配给 $c$,亦或分配给 $a$ 和 $b$ 各一个,共 $2^8$ 种三元组需要排除,同理$a=c,b=c$ 也各有 $2^8$ 种,所以相异的三元组数为:
        \[
        6^8 - 3\cdot 2^8
        \]
        将无序三元组 $(a,b,c)$ 转换为有序三元组 $(x,y,z)$,其中$x<y<z$,每个三元组对应 6 个无序三元组,因此
        \[
        N = \frac{1}{6}(6^8 - 3\cdot 2^8) = 279808
        \]
    \end{solution}

    \question 已知 $a_0, a_1, a_2, a_3, a_4$ 的值正好都是 $-1, 0, 1$ 中的数, 则 $a_0 + 3a_1 + 3^2a_2 + 3^3a_3 + 3^4a_4$ 的值是正整数共有多少个？
    \begin{solution}
        形如
        \[
        1\triangle \triangle \triangle \triangle,01\triangle \triangle \triangle,
        001\triangle \triangle,
        0001\triangle,
        00001
        \]
        的数共有
        \[
        3^4,3^3,3^2,3^1,1
        \]
        个,总计
        \[
        81 + 27 + 9 + 3 + 1 = 121
        \]
    \end{solution}

    \question 求正整数有序三元组 $(x,y,z)$ 的个数,使得
    \[
    xyz = 4000.
    \]
    \begin{solution}
        质因数分解得$4000 = 2^5 \cdot 5^3$,设
        \[
        x = 2^a 5^d, \quad y = 2^b 5^e, \quad z = 2^c 5^f,
        \]
        其中 $a,b,c,d,e,f$ 为非负整数,则需满足
        \[
        a+b+c = 5, \quad d+e+f = 3
        \]
        非负整数解的个数为
        \[
        \#(a,b,c) = \comb{5+3-1}{3-1} = 21, \quad \#(d,e,f) = \comb{3+3-1}{3-1} = 10
        \]
        因此有序三元组 $(x,y,z)$ 的个数为
        \[
        21 \cdot 10 = 210
        \]
    \end{solution}

    \question 将 $1,2,3,4,5,6,7$ 排成一列,若规定排列后不得出现 $12,23,34,45,56,67$(如：1273546 不合题意,7362154 符合题意),则有多少种排法？
    \begin{solution}
    7 个相异数字任意排列共有 $7!$ 种。

    从$12,23,34,45,56,67$选$12$后有6个板块,出现$12$的排列数为$\comb{6}{1}6!$。

    依此类推,由容斥原理,总排列数为
    \[
    7!-\comb{6}{1}6!+\comb{6}{2}5!-\comb{6}{3}4!+\comb{6}{4}3!-\comb{6}{5}2!+1=2119
    \]
    \end{solution}

    \question 如果一个数的每一位都大于前一位,则称它为上升数。例如 457 是上升数,但 447 不是。问 400 到 5000 之间共有多少上升数？
    \begin{solution}
        情况一:上升数为三位数。三位数必须在 400 到 999 之间,百位可以是 4,5,6,7,8,9。4 到 9 的 6 个数字中任选 3 个,按升序排列即可得到上升数。排列数为$\comb{6}{3}$。

        情况二:上升数为四位数。四位数小于 5000,千位必须为 1,2,3,4。1 到 9 的数字中任选 4 个,再扣除首位 $\ge 5$ 的数。排列数为$\comb{9}{4} - \comb{5}{4}$。

        因此共有 
        \[
        \comb{6}{3} + (\comb{9}{4} - \comb{5}{4}) = 141
        \]
        个这样的上升数。
    \end{solution}

    \question Ricardo 想要将三个 1、三个 2、两个 3 和一个 4 排成一个九位正整数,且满足以下条件:
    \begin{itemize}
        \item 从左到右,至少有一个 1 在第一个 2 之前,至少有一个 2 在第一个 3 之前,至少有一个 3 在 4 之前;
        \item 任意两个数字 2 不能相邻。
    \end{itemize}
    求总共有多少种符合条件的九位数。
    \begin{solution}
        设 $N$ 为满足条件的整数。$N$ 的首位必须是 1,因此 $N$ 可以以 1、11 或 111 开头。又因为第一个非 1 的数字必须是 2,所以 $N$ 只能以 12、112 或 1112 开头。
        
        情况 1:$N$ 以 12 开头。剩余两个 2 不能相邻,可放在下列位置组合(从左数第几位):
        \[
        (4,6),(4,7),(4,8),(4,9),(5,7),(5,8),(5,9),(6,8),(6,9),(7,9)
        \]
        共有 10 种可能。剩余两个 1 可以放在剩下的 5 个空位中的任意两位,有 $\comb{5}{2}=10$ 种方法。剩余的两个 3 和一个 4 需放在最后 3 个位置中。为保证至少有一个 3 在 4 之前,第一个空位必须放 3,剩下两个位置放另一个 3 和一个 4,有 2 种排列。因此本情况共有:
        \[
        10 \cdot 10 \cdot 2 = 200.
        \]
        情况 2:$N$ 以 112 开头。剩余两个 2 不能相邻,可放在:
        \[
        (5,7),(5,8),(5,9),(6,8),(6,9),(7,9)
        \]
        共有 6 种可能。剩余一个 1 可放在 4 个空位中的任意一位,有 4 种方法。剩余两个 3 和一个 4 需放在最后 3 个位置中。第一个空位放 3,剩下两个位置放另一个 3 和一个 4,有 2 种排列。本情况共有:
        \[
        6 \cdot 4 \cdot 2 = 48.
        \]
        情况 3:$N$ 以 1112 开头。剩余两个 2 不能相邻,可放在
        \[
        (6,8),(6,9),(7,9)
        \]
        共有 3 种可能。剩余的两个 3 和一个 4 需放在最后 3 个位置中。第一个空位放 3,剩下两个位置放另一个 3 和一个 4,有 2 种排列。本情况共有:
        \[
        3 \cdot 2 = 6.
        \]
        综上,共有 $200 + 48 + 6 = 254$ 种符合条件的九位数。
    \end{solution}

    \question
3) 从数字1至9中选出7位数，要求每个数字不重复，并且5和6不能连续出现，求共有多少种排列方式。

\begin{solution}
考虑不同情况：

(a) 5和6都出现：

- 情况一：第1位是5，第2位不是6：
\[
5 \times \perm{7}{5} = 12600
\]

- 情况二：第7位是5，第6位不是6：
\[
5 \times \perm{7}{5} = 12600
\]

- 情况三：5出现在首尾之外的其他位置：
\[
5 \times 4 \times \perm{7}{5} = 50400
\]

因此，5和6都出现的排列数：
\[
12600 + 12600 + 50400 = 75600
\]

(b) 5和6都不出现：
\[
\perm{7}{7} = 7! = 5040
\]

(c) 5出现但6不出现：
\[
7 \times \perm{7}{6} = 7 \times 7! = 35280
\]

(d) 5不出现但6可以出现：
\[
7 \times \perm{7}{6} = 7 \times 7! = 35280
\]

根据加法原理，总排列数为：
\[
75600 + 5040 + 2 \times 35280 = 151200
\]
\end{solution}


    \question 令 $a_n$ 为第 $n$ 小的各位数字之和为 $3$ 的正整数。例如 $a_1=3, a_2=12, a_3=21, a_4=30$。求 $a_{2012}$ 有多少位数。  
    \begin{solution}
        若一个数最多有 $d$ 位,那么其各位和为 $3$ 的这样的数的个数为
        \[
        \comb{d+2}{3}
        \]
        这是因为我们可以用隔板法来理解:将 $3$ 个相同的球(代表数字和为 3)分配到 $d$ 个位置(代表 $d$ 位数),等价于在 $d+2$ 个位置中选择 $3$ 个位置放置隔板。具体地,我们在一排 $d+2$ 个位置中放置恰好 $3$ 个 O(其余为 X),则第 $i$ 位的数字等于第 $i-1$ 个 X 与第 $i$ 个 X 之间的 O 的个数。因此需找最小的 $d$ 使得
        \[
        \comb{d+2}{3}\ge 2012.
        \]
        计算得
        \[
        \comb{23}{3}=1771,\quad \comb{24}{3}=2024.
        \]
        因此当 $d=22$ 时,$\comb{24}{3}=2024\ge2012$,且 $d=21$ 时不足。故 $a_{2012}$ 恰有 $22$ 位。
    \end{solution}

    \question 将$A,B,C,D,E,F,G,H$八个字母排成一列,使得$B$在$A$之右方,$E$在$C$与$D$之间,且$F,G$不相邻,试问符合条件的排法有多少种？
    \begin{solution}
        在所有的排列中,$B$ 在 $A$ 的右方与 $A$ 在 $B$ 的右方各占一半,因此满足"$B$ 在 $A$ 的右方"的排列占全部排列的 $\dfrac{1}{2}$。
        
        同理,在 $C,D,E$ 三个字母的相对位置中,$E$ 在 $C$ 与 $D$ 之间、$C$ 在 $E$ 与 $D$ 之间、$D$ 在 $E$ 与 $C$ 之间各占三分之一,因此满足"$E$ 在 $C$ 与 $D$ 之间"的排列占全部排列的 $\dfrac{1}{3}$。
        
        现计算满足"$F,G$ 不相邻"的排列数:
        
        八个字母的全排列有 $8!$ 种。若 $F,G$ 相邻,可将它们视为一个整体,有 $7!$ 种排法,而 $F,G$ 内部有 $2$ 种排列,因此 $F,G$ 相邻的排法有 $7! \cdot 2$ 种。
        
        所以 $F,G$ 不相邻的排法有 $8! - 7! \cdot 2$ 种。
        
        由于这三个条件相互独立,符合所有条件的排法数为:
        \[
        \frac{8! - 7! \cdot 2}{2 \cdot 3} = 5040
        \]
    \end{solution}

    \question 有 6 个人有网络账号，已知每个人都恰好与自己以外的 2 个人互为好友，则共有种不同的组成方法?
    \begin{solution}
        用六个顶点表示六个人，两顶点有连线表示两人互为好友。

        情况一:一个六边形。共有$\dfrac{5!}{2}$种。

        情况二:两个三角形。共有$\dfrac{\comb{6}{3}}{2}$种。

        因此共有
        \[
        \frac{5!}{2}+\frac{\comb{6}{3}}{2}=70
        \]
        种组合方式。
    \end{solution}

\question 求不大于 $2018$ 的正整数中,二进制中 1 出现比 0 多的个数。
\begin{solution}
    考虑不大于 $2047=2^{11}-1$且满足条件的正整数个数,再减去 2019 至 2047 的 29 个数,因为这29 个数的二进制中至少有6个1。

    对于偶数位数（去掉开头的 1 后有偶数位）,一半的数满足 1 的个数多于 0。具体公式为:
    \[
    \frac{1}{2}\left(2^{2k} + \comb{2k}{k}\right)
    \]
    因为恰好 $k$ 个 1 的情况算一半,其余一半满足条件,计算:
    \[
    \frac{1}{2}\Big(2047 + \comb{0}{0} + \comb{2}{1} + \comb{4}{2} + \comb{6}{3} + \comb{8}{4} + \comb{10}{5}\Big) = 1199
    \]
    故答案为$1199-29=1170$。
    \textcolor{red}{Half of the numbers with an even number of bits have this property, since they have an odd number of bits after their initial 1. Of the $2^{2k}$ numbers with $2k$ bits following the initial 1, the number with this property is $\frac{1}{2}(2^{2k} + \binom{2k}{k})$ since those with $k$ 1's will be included, and half of the others will.}
\end{solution}

    \question 小王有八个编号为 1 到 8 的盒子和八个编号为 1 到 8 的球。问他把球放入盒子,使每个盒子恰好有一个球,且球 1 不在盒子 1,球 2 不在盒子 2,球 3 不在盒子 3,有多少种方法？
    \begin{solution}
        设
        \[
        A_1 = \{\text{球 1 在盒子 1}\}, \quad
        A_2 = \{\text{球 2 在盒子 2}\}, \quad
        A_3 = \{\text{球 3 在盒子 3}\}.
        \]
        根据容斥原理,不允许的排列数为
        \begin{align*}
        &|A_1 \cup A_2 \cup A_3| \\
        &= |A_1| + |A_2| + |A_3| - |A_1 \cap A_2| - |A_1 \cap A_3| - |A_2 \cap A_3| + |A_1 \cap A_2 \cap A_3| \\
        &=3\cdot 7! - 3\cdot 6! + 5! = 13080           
        \end{align*}
        因此满足条件的排列数为
        \[
        S = 8! - |A_1 \cup A_2 \cup A_3| = 27240
        \]
    \end{solution}

    \question 在一排有 20 张椅子的座位区中, 要安排甲、乙、丙、丁、戊 5 人入坐, 一人坐一张椅子, 要求第一张与最后一张椅子不能安排人入坐, 且每相邻的 5 张椅子至少要有一人入坐, 任两人不能坐在相邻的椅子上。试问 5 人入坐的方法有多少种可能?
    \begin{solution}
    20 张椅子 5 人先入坐, 有 $5!$ 排法, 剩下 15 张椅子。依规定头尾各放一张, 剩下 13 张; 两人中间各摆一张, 剩下 9 张。

    9 张椅子可以在 5 人的六个间隔中摆放, 有 $\comb{9+6-1}{6-1}$ 摆法。

    为符合「相邻 5 张椅子至少要有一人坐」, 需扣除某个间隔塞入四张或以上的情形,因此实际摆法有
    \[
    5!(\comb{9+6-1}{6-1} - \comb{6}{1} \cdot \comb{6+5-1}{5-1} + \comb{6}{2} \cdot \comb{6+1-1}{1-1})= 69600
    \]
    \end{solution}

    \question 由字母 $A$ 和 $B$ 组成的 9 个字母的字母串中,有多少个不包含连续字母串 $ABBA$？
    \begin{solution}
        总字母串数为 $2^9 = 512$,我们先计算至少包含一个 $ABBA$ 的字符串数量,再用总数减去它。

        $ABBA$ 可以出现在前 6 个位置中的任意一个位置,剩余 5 个位置可以随意填充 $A$ 或 $B$,因此每个起始位置有 $2^5 = 32$ 种方法,共 $6 \cdot 32 = 192$ 种字母串。  

        这 192 种字母串中有些被重复计算,因为 $ABBA$ 可以重叠如下:
        \[
        xyABBABBA, \quad xABBABBAy, \quad ABBABBAxy
        \]
        其中 $x, y$ 可以是 $A$ 或 $B$,共有 $12$ 种。还有 6 种形为
        \[
        xABBAABBA, \quad ABBAxABBA, \quad ABBAABBAx
        \]
        这些被重复计算了 2 次。  

        根据容斥原理,因此至少包含一个 $ABBA$ 的字母串数为 $192-12-6 = 174$。故不包含 $ABBA$ 的字母串数为:
        \[
        512 - 174 = 338
        \]
    \end{solution}

    \question 设 Bauman 字串满足以下条件:
    \begin{itemize}
        \item 每个字母只能是 $A, B, C, D, E$ 之一；
        \item 相邻两个字母不能相同。
    \end{itemize}
    例如 $AECD, BDCEC$ 是 Bauman 字串,而 $ABBC, DAEEE$ 不是。
    \begin{parts}
    \part 长度为 5 的 Bauman 字串中,首尾字母都是 $A$ 的有多少个？
    \begin{solution}
        若首尾均为 $A$,则第二位和第四位不能是 $A$。按第三位分类讨论:

        情形 1:第三位是 $A$。字串形如 $A\_A\_A$,第二位有 4 种选择($B,C,D,E$),第四位有 4 种选择,共 $4 \cdot 4 = 16$ 种。

        情形 2:第三位不是 $A$。第三位有 4 种选择($B,C,D,E$),第二位需与第三位不同且不能为 $A$,共 3 种选择;第四位同理有 3 种选择,共 $4 \cdot 3 \cdot 3 = 36$ 种。

        总数为 $16 + 36 = 52$。
    \end{solution}
    \begin{solution}
        按第二位和第四位是否相同分类:

        情形 1:第二位和第四位相同。字串形如 $Ax\_xA$(其中 $x$ 表示第二位和第四位的字母),第二位有 4 种选择,第三位需与第二位不同,有 4 种选择,共 $4 \cdot 4 = 16$ 种。

        情形 2:第二位和第四位不同。字串形如 $Axy\_A$(其中 $x$, $y$ 分别表示第二位和第四位的字母),第二位有 4 种选择,第四位需与第二位不同,有 3 种选择,第三位需与第二位和第四位都不同,有 3 种选择,共 $4 \cdot 3 \cdot 3 = 36$ 种。

        总数为 $16 + 36 = 52$。
    \end{solution}
    \part 长度为 6 的 Bauman 字串中,包含超过一个 B 的有多少个？
    \begin{solution}
        总字串数为 $5 \cdot 4^5 = 5120$(首位 5 种选择,其余每位 4 种选择)。

        无 $B$ 的字串:首位 4 种选择($A,C,D,E$),其余每位 3 种选择(需与前一位不同且不能是 $B$),共 $4 \cdot 3^5 = 972$ 种。

        恰有 1 个 $B$ 的字串:
        \begin{itemize}
            \item 若 $B$ 在首位或末位:
            \begin{itemize}
                \item $B$ 在首位:第二位 4 种,其余每位 3 种,共 $1 \cdot 4 \cdot 3^4 = 324$ 种
                \item $B$ 在末位:首位 4 种,第二到第五位中第二位 3 种,其余每位 3 种,共 $4 \cdot 3^4 = 324$ 种
            \end{itemize}
            \item 若 $B$ 在第 2 到第 5 位(共 4 个位置):每个位置,$B$ 前一位 4 种,$B$ 后一位 4 种,其余 3 个位置各 3 种,每个位置贡献 $4 \cdot 1 \cdot 4 \cdot 3^3 = 432$ 种,共 $4 \cdot 432 = 1728$ 种
        \end{itemize}
        恰有 1 个 $B$ 的总数为 $324+ 324 + 1728 = 2376$。

        超过 1 个 $B$ 的数目为:
        \[
        5120 - 972 - 2376 = 1772.
        \]
    \end{solution}
    \begin{solution}
       长度为 6 的 Bauman 字串中,由于相邻字母不能相同,$B$ 最多出现 3 次。故只需计算恰有 2 个 $B$ 或恰有 3 个 $B$ 的字串数。

        情形 1:恰有 3 个 $B$。三个 $B$ 必须间隔放置。可能的位置模式有:
        \begin{itemize}
            \item $B\_B\_B\_$(第 1, 3, 5 位):第 2, 4, 6 位各 4 种选择,共 $4^3 = 64$ 种
            \item $\_B\_B\_B$(第 2, 4, 6 位):第 1, 3, 5 位各 4 种选择,共 $4^3 = 64$ 种
            \item $B\_B\_B$(第 1, 3, 5 位):第 2 位 4 种,第 4 位 4 种,第 6 位 3 种,共 $4 \cdot 4 \cdot 3 = 48$ 种
            \item $\_B\_B\_$(第 2, 4, 6 位):第 1 位 4 种,第 3 位 4 种,第 5 位 3 种,共 $4 \cdot 4 \cdot 3 = 48$ 种
        \end{itemize}
        合计 $64 + 64 + 48 + 48 = 224$ 种。

        情形 2:恰有 2 个 $B$。从 6 个位置中选 2 个放 $B$,有 $\comb{6}{2} = 15$ 种选择,但需排除相邻的 5 种,剩余 10 种位置模式。

        逐一计数(用下划线表示非 $B$ 位置):
        \begin{itemize}
            \item $B\_\_\_B\_$:第 2 位 4 种,第 4 位 4 种,第 5, 6 位各 3 种,共 $4 \cdot 4 \cdot 3 \cdot 3 = 144$ 种
            \item $\_\_B\_\_B$:对称,同样 $144$ 种
            \item $B\_\_B\_\_$:第 2, 4 位各 4 种,第 5 位需与第 4 位不同有 3 种,第 6 位 3 种,共 $4 \cdot 4 \cdot 3 \cdot 3 = 144$ 种
            \item $\_\_B\_B\_$:对称,同样 $144$ 种
            \item $B\_B\_\_\_$:第 2 位 4 种,第 4, 5, 6 位各 3 种,共 $4 \cdot 3 \cdot 3 \cdot 3 = 108$ 种
            \item $\_\_\_B\_B$:对称,第 1 位 4 种,第 2, 3 位各 3 种,第 5 位 3 种,共 $4 \cdot 3 \cdot 3 \cdot 3 = 108$ 种
            \item $B\_B\_\_\_$:第 2 位 4 种,第 4 位需与第 3 位不同有 4 种,第 5, 6 位各 3 种,共 $4 \cdot 4 \cdot 3 \cdot 3 = 144$ 种
            \item $\_\_B\_B$:对称,同样 $144$ 种
            \item $B\_\_\_\_B$:第 2 位 4 种,第 3, 4, 5 位各 3 种,共 $4 \cdot 3^3 = 108$ 种
            \item $\_B\_B\_\_$:第 1, 3, 5 位各 4 种,第 6 位 3 种,共 $4^3 \cdot 3 = 192$ 种
        \end{itemize}
        合计 $4 \cdot 144 + 2 \cdot 108 + 2 \cdot 144 + 108 + 192 = 1548$ 种。

        恰 2 个 $B$ 的有 1548 种,恰 3 个 $B$ 的有 224 种,总和为 $1548 + 224 = 1772$。
    \end{solution}
    \end{parts}


    \question 将字母串 $AAAABBBCCC$ 排成一列,且相同字母不相邻的排法有多少种？
    \begin{solution}
        按 $B,C$ 的排列分类,再插入 $A$。先排列 3 个 $B$ 和 3 个 $C$ 的相对次序,记为「$BC$ 串」。共有
        \[
        \comb{6}{3}=\frac{6!}{3!3!}=20
        \]
        种 $BC$ 串。按 $BC$ 串中出现相邻同字母的"块数"分类,列举如下:
        \begin{center}
        \begin{tabular}{c|l}
        编号 & 字串 \\ \hline 
        1 & $BCBCBC$ \\ 
        2 & $CBCBCB$ \\ \hline 
        3 & $BCCBCB$ \\ 
        4 & $CBCBBC$ \\ 
        5 & $BCBCCB$ \\ 
        6 & $CBBCBC$ \\ \hline 
        7 & $BCCBBC$ \\ 
        8 & $CCBBCB$ \\ 
        9 & $BCBBCC$ \\ 
        10 & $CCBCBB$ \\ 
        11 & $BBCCBC$ \\ 
        12 & $CBBCCB$ \\ 
        13 & $BBCBCC$ \\ 
        14 & $CBCCBB$ \\ \hline 
        15 & $CBBBCC$ \\ 
        16 & $CCBBBC$ \\ 
        17 & $BBCCCB$ \\ 
        18 & $BCCCBB$ \\ \hline 
        19 & $CCCBBB$ \\ 
        20 & $BBBCCC$ \\ \hline
        \end{tabular}
        \end{center}
        现在将 4 个 $A$ 插入 $BC$ 串的空位中,使得任何相同字母都不相邻:
        \begin{enumerate}
            \item $BC$ 串中没有相邻同字母（编号 1--2）:有 7 个空位插入 4 个 A,方式数 $\comb{7}{4}=35$,对应 2 种 $BC$ 串,共 $2\cdot 35=70$。
            \item 有 1 处相邻同字母（编号 3--6）:此时剩 6 个空位插入 4 个 A（等价插入 3 个 A 以避免产生相邻相同字母）,方式数 $\comb{6}{3}=20$,对应 4 种 $BC$ 串,共 $4\cdot20=80$。
            \item 有 2 处相邻同字母（编号 7--14）:剩 5 个空位插入 2 个 A,方式数 $\comb{5}{2}=10$,对应 8 种 $BC$ 串,共 $8\cdot10=80$。
            \item 有 3 处相邻同字母（编号 15--18）:剩 4 个空位插入 1 个 A,方式数 $\comb{4}{1}=4$,对应 4 种 $BC$ 串,共 $4\cdot4=16$。
            \item 有 4 处相邻同字母（编号 19--20）:A 恰好插满一组,计 $2$ 种。
        \end{enumerate}
        合计:
        \[
        70+80+80+16+2=248
        \]
    \end{solution}
    \begin{solution}
        根据容斥原理,相同字母不相邻的排法数
        \[
        = \text{4个A不相邻} - (\text{至少2个B相邻} \cup \text{至少2个C相邻})
        \]
        4个A不相邻:先排 3 个 $B$ 和 3 个 $C$,有 $\comb{6}{3}=20$ 种方式,产生 7 个空位,在其中插入 4 个 $A$,有 $\comb{7}{4}=35$ 种方式,共 $20 \cdot 35=700$ 种。

        至少2个B相邻:将 2 个 $B$ 看作一个整体 $BB$,与剩余 1 个 $B$ 和 3 个 $C$ 排列,有 $\frac{5!}{3!}=20$ 种方式,产生 6 个空位插入 4 个 $A$,有 $\comb{6}{4}=15$ 种方式,共 $20 \cdot 15=300$ 种。

        但这样会重复计算 3 个 $B$ 都相邻的情况。当 3 个 $B$ 都相邻时,将它们看作 $BBB$,与 3 个 $C$ 排列有 4 种方式,产生 5 个空位插入 4 个 $A$,有 $\comb{5}{4}=5$ 种方式,共 $4 \cdot 5=20$ 种。

        因此至少 2 个 $B$ 相邻为 $300-20=280$ 种。

        由对称性,至少 2 个 $C$ 相邻也是 $280$ 种。

        至少2个B相邻且至少2个C相邻:将 2 个 $B$ 看作 $BB$,2 个 $C$ 看作 $CC$,与剩余 1 个 $B$ 和 1 个 $C$ 排列,有 $4!=24$ 种方式,产生 5 个空位插入 4 个 $A$,有 $\comb{5}{4}=5$ 种方式,共 $24 \cdot 5=120$ 种。

        需扣除 3 个 $B$ 都相邻的情况:$BBB,CC,C$ 排列有 $3!=6$ 种,产生 4 个空位插入 4 个 $A$,有 $\comb{4}{4}=1$ 种,共 $6 \cdot 1=6$ 种。

        同样扣除 3 个 $C$ 都相邻的情况:$6$ 种。

        因此至少 2 个 $B$ 相邻且至少 2 个 $C$ 相邻为 $120-6-6=108$ 种。

        最终答案为 
        \[
        \comb{6}{3}\comb{7}{4} - \left[2 \times \left(\frac{5!}{3!}\comb{6}{4}-4\comb{5}{4}\right) - \left(4!\comb{5}{4}-2 \times 3!\comb{4}{4}\right)\right]=248
        \]
    \end{solution}

    \question 要爬 12 级台阶,但每步只能上 1 级或 2 级。第 8 级有一条蛇,所以不能踩。问共有多少种爬法？
    \begin{solution}
        由于第 8 级不能踩,必须从第 7 级迈 2 级直接到第 9 级。于是问题可以拆成两段:
        \begin{itemize}
            \item 爬前 7 级的方式数
            \item 从第 9 级到第 12 级的方式数
        \end{itemize}
        总数为
        \[
        (\comb{7}{0}+\comb{6}{1}+\comb{5}{2}+\comb{4}{3})\cdot 3=63
        \]
    \end{solution}

    \question 在集合 $\{1,2,3,4,5,6,7\}$ 的所有非空子集 S 中,有多少个子集不包含数 $|S|$($|S|$ 表示子集元素个数)？例如 $\{3,4\}$ 是这样的子集,因为它不包含数字 2。
    \begin{solution}
        非空子集总数为 $2^7-1=127$。若子集大小为 $k$ 且包含数字 $k$,则剩下的 $k-1$ 个元素必须从另外的 6 个数中选取,共有
        \[
        \comb{6}{k-1}
        \]
        种。对 $k=1,2,\dots,7$ 求和得包含其大小的子集总数为
        \[
        \sum_{k=1}^7 \comb{6}{k-1} = \sum_{j=0}^6 \comb{6}{j} = 2^6 = 64.
        \]
        因此不包含其大小的子集个数为
        \[
        127-64=63.
        \]
    \end{solution}

    \question 有多少个非负整数有序四元组 $(a,b,c,d)$ 满足 $a+b+c+d\le15$?
    \begin{solution}
        将不等式转化为等式
        \[
        a+b+c+d+e=15,
        \]
        其中 $e\ge0$,则原题等价于求此方程的非负整数解个数。根据隔板法,有
        \[
        \comb{15+5-1}{5-1}=\comb{19}{4}=3876
        \]
        个非负整数有序四元组。
    \end{solution}

    \question 以一个正方体的顶点为顶点的四面体共有多少个？
    \begin{solution}
        从正方体的 8 个顶点中任取 4 点:
        \[
        \comb{8}{4} = 70
        \]
        需扣除 4 点共平面的情形,包括正方体的六个面,共 6 种;斜平面,共 6 种。所以四面体个数为
        \[
        70 - 12 = 58
        \]
    \end{solution}

    \question 在 5 只蜗牛进行的比赛中,最多只会出现一次打平,但可以接受任意数量的蜗牛打平。例如,比赛结果可能是 Dazzler 获得第一名;Abby、Cyrus 和 Elroy 并列第二名,而 Bruna 获得第五名。问这种比赛共有多少种不同的结果? 
    \begin{solution}
        考虑没有、两只、三只、四只、五只蜗牛打平,总共有
        \[
        5! + \comb{5}{2} \cdot 4! + \comb{5}{3} \cdot 3! + \comb{5}{4} \cdot 2! + 1 = 431
        \]
        个不同的结果。
    \end{solution}

    \question 在一个 $3 \times 3$ 的网格中,放置 $3$ 个红色棋子、$3$ 个蓝色棋子和 $3$ 个绿色棋子,所有棋子同色不可相邻（横或竖方向）,且棋子同色不可区分。请问满足条件的放置方法有多少种？
        \ifprintanswers
        \begin{figure}[H]
        \centering
        \includegraphics[width=0.4\textwidth]{images/image13.png}
        \end{figure}
        \fi
    \begin{solution}
        观察发现,只存在两种基本的放置方法（如上图所示）,其他放置方法只能通过这两种结构旋转或颜色变化得到,所以总合法方案数为
        \[
        (4 + 2) \cdot 3! = 36
        \]
    \end{solution}

    \question 小明在注册账号时可以使用字符$1,2,3,a,b,c,A,B,C$来组成五位密码,但要求必须包含数字、小写字母和大写字母,且不可以出现两个相同的字符相邻,例如密码可以设置为$123aA$或$laA12$,但不能设置为$123ab$或$112aA$,试求可以设置不同的密码的个数。
    \begin{solution}
        先考虑相邻字符不同的密码,共有$9 \cdot 8^4 = 36864$种,这里面不满足密码要求的有两类:
        \begin{itemize}
            \item 仅包含单一字符类型(如全数字),这类共有$3 \cdot (3 \cdot 2^4) = 144$种
            \item 仅包含两种字符类型(如数字和小写字母),只满足相邻不同的密码有$6 \cdot 5^4 = 3750$种,但此时我们多算了$2 \cdot (3 \cdot 2^4) = 96$种单一字符类型, 故第二类共有$3 \cdot (3750 - 96) = 10962$种
        \end{itemize}
        不同密码的总个数为$36864 - 144 - 10962 = 25758$.
    \end{solution}

    \question 阿绿想在她的表演服装上缝 6 颗相同的红色钮扣、3 颗相同的绿色钮扣和 3 颗相同的黄色钮扣。若所有钮扣需竖直地排成一直线,且相邻钮扣不同色,则阿绿有多少种排列方法?
    \begin{solution}
        假设红、绿、黄钮扣为$R,G,Y$,先将 $6R$ 排成一列,共 $7$ 个间隔。由于同色不相邻,必须将中间 $5$ 个间隔放入 $3G$ 与 $3Y$ 中的五个。

        情况一: 5 个间隔放 $3G2Y$ 且剩下 $1Y$ 放头或尾端。排列数有$\comb{5}{3}\cdot 2$。

        情况二: 5 个间隔放 $2G3Y$ 且剩下 $1G$ 放头或尾端。排列数有$\comb{5}{3}\cdot 2$。

        情况三: 5 个间隔放 $3G2Y$ 且剩下 $1Y$ 不放头尾。可能情况有$G\cdot G\cdot Y\cdot Y\cdot \boxed{GY},G\cdot G\cdot Y\cdot Y\cdot \boxed{YG}$,排列数各有 $\dfrac{5!}{2!2!}$。

        故排列方法共有
        \[
        \comb{5}{3}\cdot 2+\comb{5}{3}\cdot 2+\frac{5!}{2!2!}+\frac{5!}{2!2!}=100
        \]
    \end{solution}

    
    \question 在一个 $3\times3$ 的方格中,每个小方格被涂成红、白、蓝、绿四种颜色中的一种,要求任何 $2\times2$ 的小方格块都恰好包含四种不同的颜色。共有多少种不同的涂色方案？
    \begin{solution}
        先固定中心格:中心格有 $4$ 种颜色可选。再考虑中心行的左右两格:
        \begin{itemize}
        \item 两格同色。共有 $3$ 种颜色可供选择,此时上下行个别有$2$种填色方法,共 $2^2=4$ 种合法填法。  
        \item 两格异色。左格 $3$ 种选,右格再 $2$ 种选,共 $3\cdot2=6$ 种。在此情况下,其余 4 个角格的颜色被唯一地确定。
        \end{itemize}
        故方法数共有 
        \[
        4 \cdot (3 \cdot 4 + 6) =72
        \]
    \end{solution}

    \question Rita 正在给一朵花涂色。她已经涂好了花心和花茎。接下来,她将用红色、橙色、黄色和蓝色给六片花瓣涂色,每片花瓣只用一种颜色。规则如下:
    \begin{itemize}
        \item 相邻的花瓣不能涂相同的颜色；
        \item 不一定要用到所有四种颜色。
    \end{itemize}
    求共有多少种不同的涂法数?
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{images/image170.png}
    \end{figure}
    \begin{solution}
        不失一般性,假设顶端花瓣为红色。

        情况 1:红色出现三次。由于相邻花瓣不能同色,红色只能出现在特定的三片花瓣上,其余三片花瓣可以任意用其他3种颜色涂色,因此这种情况下共有
        \[
        3^3 = 27 \text{ 种涂法。}
        \]
        情况 2:红色出现两次。分情况讨论,
        \begin{itemize}
            \item 两红色花瓣之间相隔两个花瓣。与顶端红色花瓣相邻的两片花瓣可以各自用3种颜色涂色,剩余两片花瓣可以各自用2种颜色涂色,总共有
            \[
            3 \cdot 3 \cdot 2 \cdot 2 = 36 \text{ 种方式。}
            \]
            \item 两红色花瓣之间相隔一个花瓣。两红色花瓣可能在顶端及左侧或右侧,红色花瓣之间的花瓣可以用3种颜色,其他三片花瓣根据两种或三种颜色组合有 $6+6=12$ 种方式,因此该配置共有
            \[
            2 \cdot 3 \cdot 12 = 36 \text{ 种方式。}
            \]
        \end{itemize}
        情况 3:红色出现一次。按顺时针给花瓣涂色（从红色顶端开始）:第一片花瓣有 3 种选择,接下来的四片花瓣每片有 2 种选择（不能和相邻花瓣相同,也不能用红色）,因此共有
        \[
        3 \cdot 2 \cdot 2 \cdot 2 \cdot 2 = 48 \text{ 种方式。}
        \]
        顶端花瓣可以选择 4 种颜色,故
        \[
        N = 4 \cdot (27 + (36+36) + 48) = 732
        \]
    \end{solution}

    \question 一位农夫拥有一个矩形农田,它被划分成 $2\times2$ 的四块矩形区域。在每块区域中,农夫将种植一种作物:玉米、小麦、大豆或土豆。农夫不希望玉米和小麦出现在相邻的两块地中,也不希望大豆和土豆出现在相邻的两块地中。在这些限制下,农夫有多少种不同的方法为这四块地选择作物？
    \begin{solution}
        注意到:对于每种作物,有恰好一种作物是不能与其相邻的。不失一般性,设左上角种的是小麦。

        情况一:左上角右边和下边两个相邻地块种的是相同的作物。这两块地不能种玉米（因为玉米不能与小麦相邻）,因此它们可以是小麦、大豆或土豆中的一种,共有 $3$ 种选择,对于右下角地块,只要与周围的两块地都不冲突即可,有 $3$ 种选择。
        
        情况二:右边和下边两块地种的是不同的作物。可从 $3$ 种合法作物中选择两个不同的,并安排在右和下两个位置,共有 $3 \cdot 2 = 6$ 种方式,此时右下角地块的选择只有 $2$ 种。
        
        综合两种情况相加并乘以左上角作物的 $4$ 种选择,总方法数为
        \[
        4 \cdot (3 \cdot 3 + 6 \cdot 2) = 84 
        \]
    \end{solution}
            
\question 三双不同的鞋子被排成一列,要求不能有一只左脚鞋与另一双的右脚鞋相邻。问共有多少种排法？
\begin{solution}
    设鞋子编号如下:右脚鞋:$1,\ 2,\ 3$,左脚鞋:$4,\ 5,\ 6$,其中 $n$ 与 $n+3$ 配对（例如 $1$ 和 $4$ 是一对）。

    不妨设右脚鞋 $1$ 出现在排列中的第二个位置。此时我们枚举前三个位置可能的情况:
    \begin{itemize}
        \item 剩下的三个鞋子只能是
            \[
            654 \quad \text{或} \quad 645
            \]
            因为 $5$ 或 $4$ 不可以和 $3$（另一双的右脚鞋）相邻。
        \item 剩下的三个鞋子只能是
            \[
            563
            \]
            （不能选 $365$,因为 $6$ 和 $5$ 是不同双鞋的左、右脚,会相邻）
        \item 剩下的三个鞋子可以是
            \[
            256 \quad \text{或} \quad 652
            \]
    \end{itemize}
    所以总方法数为
    \[
    (2 + 1 + 2) \times 12 = \boxed{60}
    \]
    其中乘上 $12$ 是因为我们一开始假设了鞋子 $1$ 出现在第二位,实际有 $2$ 种选哪个右脚鞋先出现,$6$ 种选配对顺序,所以总共乘 $12$。
    \textcolor{red}{实际有 $2$ 种选哪个右脚鞋先出现?}
\end{solution}

    \question 竹东高中的多元选修课程共开设了六门选修课:$A,B,C $为第一类选修课,$D,E,F$ 为第二类选修课,要求每名同学须从中选修三门课,第一类选修课至少要选两门。现有甲、乙、丙三位同学选课,则任意一位同学与其他两位同学均至少有两门相同选修课的选法共有几种？
    \begin{solution}
        每个同学可能的选法有$$ABC, ABD, ABE, ABF, ACD, ACE, ACF, BCD, BCE, BCF,$$共 10 种；甲、乙、丙三人共有 $10^3=1000$ 种选法。

        不符规定的选法分析如下:
        \begin{itemize}
            \item 第一人选了 $ABC$:第二人在第一类有 $\comb{3}{2}=3$ 种选法,第三人在第一类只能与第二人重复一门课,因此有 2 种选法；第二人在第二类的课程有 3 种选择,第三人有 2 种选择,共有 $3\cdot2 \cdot 3\cdot2 =108$ 种。
            \item 第一人、第二人在第一类完全相同:第三人在第一类只有 2 种选择,在第二类课程中三人任选再扣除三人完全相同,即 $3^3-3$；共有 $\comb{3}{2} \cdot 3 \cdot 2 \cdot (3^3-3) =432$ 种。
            \item 三人在第一类彼此最多重复一门课:第一类的选择有 $3!=6$,第二类与情况(2)相同,即 $3^3-3$；共有 $6 \cdot (3^3-3) =144$ 种。
        \end{itemize}
        因此符合要求的选法共有
        \[
        1000-108-432-144 = 316
        \]
    \end{solution}

    \question 下图显示了一个宽为3格、高为3格的点阵,共包含9个小正方形。Carl 在这些正方形的边上放置长为 \(\dfrac{1}{2}\) 英寸的牙签,要求形成一个不相交的闭合环。图中某些格子内标注了一个数字,表示该格子被牙签覆盖的边数。若无数字,则该格子可以被任意数量的牙签覆盖。求 Carl 放置牙签的可能方法数。  
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.4\textwidth]{images/image7.png}
    \end{figure}
    \begin{solution}
        由于牙签回路不能穿过中间的五列,所以整个回路只有两种大致布局:

        情况一:不穿过第二行。只剩下 $2$ 种回路（对称）。
        
        情况一:必须穿过第二行（左、右各穿一次）。则
        \begin{itemize}
          \item 中间四个标 $1$ 的小方格,各有两种放牙签方式,共 $2^4$;
          \item 回路在左右两侧穿过第二行,各有 $3$ 种走法,共 $3^2$。
        \end{itemize}
        因此所有合法回路总数为
        \[
        2^4 \cdot 3^2 + 2 = 146
        \]
    \end{solution}

    \question 有一张由 $5\times6$ 个正方形组成的格线纸,如右图。小强想沿着实线以向左、向右及向下的方向将格线纸剪成两张面积相等的纸张,并且先由 $A$ 点向下剪一格,最后从 $B,C,D,E,F$ 中某一点剪断纸张。问有多少种不同的剪法?
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.3\textwidth]{images/image95.png}
    \end{figure}
    \ifprintanswers
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.4\textwidth]{images/image96.jpg}
    \end{figure}
    \fi
    \begin{solution}
        格线纸共有 $5 \times 6 = 30$ 个方格。设剪线左侧从上往下第 $1,2,3,4,5$ 行的方格数分别为 $2,x,y,z,w$,需满足
        \[
        2 + x + y + z + w = 15,\quad 1 \le x,y,z,w \le 5, \quad x,y,z,w \in \mathbb{N}
        \]
        令 $x' = x - 1, y' = y - 1, z' = z - 1, w' = w - 1$,则
        \[
        x' + y' + z' + w' = 9, \quad 0 \le x',y',z',w' \le 4
        \]
        总方法数即不考虑$0 \le x',y',z',w' \le 4$的情况扣除 $x',y',z',w'$ 中至少有一个大于 $4$ 的情况:
        \[
        \comb{9+4-1}{4-1} - 4 \cdot \comb{4+4-1}{4-1} = 80
        \]
    \end{solution}

    \question 考虑集合 $\{1,2,3,\dots,2024\}$ 的所有恰有 1000 个元素的子集。对于每个这样的子集 $S$,记 $m(S)$ 为 $S$ 中的最小元素。求所有 $m(S)$ 的算术平均数。
    \begin{solution}
        设最小元素为 $a$,则有选择余下 $999$ 个元素的方法数为
        \[
        \comb{2024 - a}{999}, \quad a=1,2,\dots,1025 \quad (1025=2024-999).
        \]
        算术平均数为
        \[
        \frac{\displaystyle \sum_{a=1}^{1025} a \cdot \comb{2024 - a}{999}}{\displaystyle\sum_{a=1}^{1025} \comb{2024 - a}{999}}=\frac{\comb{2025}{1001}}{\comb{2024}{1000}} = \frac{2025}{1001}
        \]
        利用组合恒等式 $\sum_{k=r}^{n} \comb{k}{r} = \comb{n+1}{r+1}$,令 $k = 2024-a$,当 $a$ 从 1 到 1025 时,$k$ 从 2023 到 999:
        \[
        \sum_{a=1}^{1025} \comb{2024 - a}{999} = \sum_{k=999}^{2023} \comb{k}{999} = \comb{2024}{1000}
        \]
        利用恒等式:
\[
\sum_{i=r}^{n} \comb{i}{r} = \comb{n+1}{r+1}
\]

以及权重求和恒等式:
\[
\sum_{k=0}^{n} (k+1) \cdot \comb{n-k}{r} = \comb{n+1}{r+2}
\]

令 $k = a-1$,则 $a = k+1$,当 $a$ 从 1 到 1025 时,$k$ 从 0 到 1024:
\[
\sum_{a=1}^{1025} a \cdot \comb{2024-a}{999} = \sum_{k=0}^{1024} (k+1) \cdot \comb{2024-(k+1)}{999} = \sum_{k=0}^{1024} (k+1) \cdot \comb{2023-k}{999}
\]

利用恒等式 $\sum_{k=0}^{n-r} (k+1) \cdot \comb{n-k}{r} = \comb{n+2}{r+2}$:

令 $n = 2023$, $r = 999$:
\[
\sum_{k=0}^{1024} (k+1) \cdot \comb{2023-k}{999} = \comb{2025}{1001}
\]
        \textcolor{red}{(待解)}
    \end{solution}

    \question 用数字 1、2、3 组成 10 位数,要求其中数字 1 出现次数为偶数。求这样的 10 位数的个数。
    \begin{solution}
        设 \(a_n\) 表示长度为 \(n\) 的、由 1、2、3 组成且数字 1 出现偶数次的序列个数。
        \begin{itemize}
            \item 若首位为 2 或 3（共 2 种选择）,则余下 \(n-1\) 位仍需 1 出现偶数次,方案数为 \(2a_{n-1}\)。
            \item 若首位为 1（1 种选择）,则已有一个 1,余下 \(n-1\) 位中 1 需出现奇数次。余下 \(n-1\) 位的总序列数为 \(3^{n-1}\),其中 1 出现偶数次的为 \(a_{n-1}\),故出现奇数次的为 \(3^{n-1} - a_{n-1}\)。
        \end{itemize}
        因此,当 \(n > 1\) 时,有递推关系：
        \[
        a_n = 2a_{n-1} + (3^{n-1} - a_{n-1}) = a_{n-1} + 3^{n-1}, \quad a_1 = 2
        \]
        求通项
        \[
        a_n = a_1 + \sum_{k=1}^{n-1} 3^k =2 + \frac{3(3^{n-1} - 1)}{2}=\frac{3^n + 1}{2}
        \]
        代入 \(n=10\)得
        \[
        a_{10} = \frac{3^{10} + 1}{2} = 29525
        \]
    \end{solution}

    \question 某语言只使用字母 $A, B, C, D, E$,其中 $A$ 和 $E$ 为元音,$B, C, D$ 为辅音。一个字母序列称为单词,当且仅当它不含有相邻两个相同字母,且不含有相邻两个元音。问该语言中长度为 10 且以元音开头的单词有多少个？
    \begin{solution}
        设 $v_n$ 为长度为 $n$ 且以元音开头的单词数,$c_n$ 为长度为 $n$ 且以辅音开头的单词数。据题意,
        \[
        v_1=2,\ c_1=3
        \]
        若 $n\ge2$,则  
        \[
        v_n=2c_{n-1},
        \]
        因为在辅音开头的 $(n-1)$ 字母单词前可加 $A$ 或 $E$。且有  
        \[
        c_n=3v_{n-1}+2c_{n-1},
        \]
        其中 $3v_{n-1}$ 意味可在元音开头的 $(n-1)$ 字母单词前加 $B, C, D,2c_{n-1}$ 意味可在辅音开头的 $(n-1)$ 字母单词前加不同于首字母的两个辅音。递推如下表:
        \begin{center}
        \begin{tabular}{|c|c|c|}
        \hline
        $n$ & $v_n$ & $c_n$ \\
        \hline
        1 & 2 & 3 \\
        2 & 6 & 12 \\
        3 & 24 & 42 \\
        4 & 84 & 156 \\
        5 & 312 & 564 \\
        6 & 1128 & 2064 \\
        7 & 4128 & 7512 \\
        8 & 15024 & 27408 \\
        9 & 54816 & 99888 \\
        10 & 199776 & 364224 \\
        \hline
        \end{tabular}
        \end{center}
        因此,长度为 10 且以元音开头的单词共有 $199776$ 个。
    \end{solution}

    \question 有六个格子,初始时三个硬币从左到右依次占据前三个格子（记为 $X,Y,Z$）。一次移动是将某一枚硬币向右移动一格,前提是目标格子为空,且硬币之间不能相互跳跃（因此三枚硬币的相对顺序始终保持 $X$ 在 $Y$ 左边,$Y$ 在 $Z$ 左边）。问：有多少种不同的移动序列,能使三枚硬币最终全部移动到最右边的三个格子？
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{images/image162.png}
    \end{figure}
    \begin{solution}
        我们将每个允许的移动序列看作由 $X,Y,Z$ 组成的字符串。例如,字符串 $ZZYXZ$ 表示先移动 $Z$ 一格,再移动 $Z,Y,X,Z$。  

        对于每个整数三元组 $(x,y,z)$,其中 $0 \le x,y,z \le 3$,定义 $S(x,y,z)$ 为使 X 移动 $x$ 格,Y 移动 $y$ 格,Z 移动 $z$ 格的移动序列数。欲求 $S(3,3,3)$。  

        由于硬币不能交叉且只能向右移动,当 $x > y$ 或 $y > z$ 或 $x > z$,有$S(x, y, z) = 0$。因此仅需考虑 $0 \le x \le y \le z \le 3$ 的情况。此时有
        \[
        S(x,y,z) = S(x-1,y,z) + S(x,y-1,z) + S(x,y,z-1)
        \]
        其中当 $x=0$ 时 $S(x-1,y,z)=0,y=0$ 时 $S(x,y-1,z)=0,z=0$ 时 $S(x,y,z-1)=0$,且  
        \[
        S(0,0,0) = 1, \quad S(1,0,0) = 0, \quad S(0,1,0) = 0, \quad S(0,0,1) = 1
        \]
        接下来通过表格逐步填入 $S(x, y, z)$,其中 $z = 1,2,3$,纵轴为 $y$,横轴为 $x$。
        \[  
        \begin{tabular}{c c c}
            \begin{tabular}{|c|cccc|}
            \multicolumn{1}{c}{} & \multicolumn{4}{c}{$x$} \\
            \cline{2-5}
            \multicolumn{1}{c|}{$y$} & 0 & 1 & 2 & 3 \\
            \cline{1-5}
            0 & 1 & 0 & 0 & 0 \\
            1 & 1 & 1 & 0 & 0 \\
            2 & 0 & 0 & 0 & 0 \\
            3 & 0 & 0 & 0 & 0 \\
            \cline{1-5}
            \end{tabular} &
            \begin{tabular}{|c|cccc|}
            \multicolumn{1}{c}{} & \multicolumn{4}{c}{$x$} \\
            \cline{2-5}
            \multicolumn{1}{c|}{$y$} & 0 & 1 & 2 & 3 \\
            \cline{1-5}
            0 & 1 & 0 & 0 & 0 \\
            1 & 2 & 3 & 0 & 0 \\
            2 & 2 & 5 & 5 & 0 \\
            3 & 0 & 0 & 0 & 0 \\
            \cline{1-5}
            \end{tabular} &
            \begin{tabular}{|c|cccc|}
            \multicolumn{1}{c}{} & \multicolumn{4}{c}{$x$} \\
            \cline{2-5}
            \multicolumn{1}{c|}{$y$} & 0 & 1 & 2 & 3 \\
            \cline{1-5}
            0 & 1 & 0 & 0 & 0 \\
            1 & 3 & 6 & 0 & 0 \\
            2 & 5 & 16 & 21 & 0 \\
            3 & 5 & 21 & 42 & 42 \\
            \cline{1-5}
            \end{tabular} \\
            $z=1$ & $z=2$ & $z=3$
        \end{tabular}
        \]
        由表得 
        \[
        S(0,0,1)=1(Z),\quad S(0,1,1)=1(ZY),\quad S(1,1,1)=1
        (ZYX)
        \]
        因此序列的数量为$S(3,3,3)=42$。
    \end{solution}

    \question 给定数字集合 $\{1, 2, 4, 8, 16, 32, 64, 128\}$,每个数字最多可使用 $3$ 次,问：用这些数字之和恰好等于 $530$ 的方案数有多少种？
    \begin{solution}
        每个数字 $2^k$ 可以出现 $0,1,2,3$ 次,对应多项式
        \[
        1 + x^{2^k} + x^{2\cdot 2^k} + x^{3\cdot 2^k}.
        \]
        考虑生成函数
        \[
        (1+x+x^2+x^3)(1+x^2+x^4+x^6)(1+x^4+x^8+x^{12}) \cdots (1+x^{128}+x^{256}+x^{384}).
        \]
        因式分解得
        \[
        \frac{x^4-1}{x-1}\cdot\frac{x^8-1}{x^2-1}\cdots \frac{x^{512}-1}{x^{128}-1}
        = (1+x+x^2+\cdots+x^{255})(1+x^2+x^4+\cdots+x^{510}).
        \]
        要得到 $x^{530}$,记作 $x^{2i}\cdot x^{530-2i}$,其中 $10 \le i \le 127$,共有 118 个 $i$ 的取值,因此方法数为 $118$。
    \end{solution}

    \question 求正整数有序三元组 $(a_1, a_2, a_3)$ 的个数,使得
    \[
    a_1 + a_2 + a_3 = 2020, \quad a_1 \not\equiv 0 \pmod 2, \quad a_2 \not\equiv 0 \pmod 3, \quad a_3 \not\equiv 0 \pmod 4。
    \]
    \begin{solution}
        $a_1$ 为奇数,生成函数为
        \[
        x + x^3 + x^5 + \cdots = \frac{1}{1-x} - \frac{1}{1-x^2} = \frac{x}{1-x^2}
        \]
        $a_2$ 不可被 3 整除,生成函数为
        \[
        x + x^2 + x^4 + x^5 + \cdots = \frac{1}{1-x} - \frac{1}{1-x^3} = \frac{x(1-x^2)}{(1-x)(1-x^3)}
        \]
        $a_3$ 不可被 4 整除,生成函数为
        \[
        x + x^2 + x^3 + x^5 + x^6 + x^7 + \cdots = \frac{1}{1-x} - \frac{1}{1-x^4} = \frac{x(1-x^3)}{(1-x)(1-x^4)}
        \]
        三式相乘得总生成函数
        \[
        \frac{x}{1-x^2} \cdot \frac{x(1-x^2)}{(1-x)(1-x^3)} \cdot \frac{x(1-x^3)}{(1-x)(1-x^4)} = \frac{x^3}{(1-x)^2(1-x^4)}
        \]
        因此所求为 $x^{2020}$ 的系数,即 $x^{2017}$ 在
        \[
        (1 + 2x + 3x^2 + \cdots)(1 + x^4 + x^8 + \cdots)
        \]
        中的系数,即
        \[
        2 + 6 + 10 + \cdots + 2018 = 505 \cdot 1010 = 510050
        \]
    \end{solution}

    \question 给定正立方体 $ABCD-EFGH$,其中 $ABCD$ 为底面,$EFGH$ 为顶面,$A$ 与 $E$ 对应,$B$ 与 $F$ 对应,$C$ 与 $G$ 对应,$D$ 与 $H$ 对应。一只小虫从顶点 $A$ 出发,每分钟沿一条棱移动到相邻顶点（每次移动一条棱）。问：经过恰好 $9$ 分钟后,小虫到达顶点 $G$ 的不同路径数为多少？
    \begin{solution}
        转换矩阵为
        \[
        A=
        \begin{bmatrix}
        0 & 1 & 0 & 1 & 1 & 0 & 0 & 0 \\
        1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\
        0 & 1 & 0 & 1 & 0 & 0 & 1 & 0 \\
        1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 \\
        1 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \\
        0 & 1 & 0 & 0 & 1 & 0 & 1 & 0 \\
        0 & 0 & 1 & 0 & 0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 1 & 1 & 0 & 1 & 0
        \end{bmatrix}
        \]
        发现
        \[
        A^9=
        \begin{bmatrix}
        0 & 4921 & 0 & 4921 & 4921 & 0 & 4920 & 0 \\
        4921 & 0 & 4921 & 0 & 0 & 4921 & 0 & 4920 \\
        0 & 4921 & 0 & 4921 & 4920 & 0 & 4921 & 0 \\
        4921 & 0 & 4921 & 0 & 0 & 4920 & 0 & 4921 \\
        4921 & 0 & 4920 & 0 & 0 & 4921 & 0 & 4921 \\
        0 & 4921 & 0 & 4920 & 4921 & 0 & 4921 & 0 \\
        4920 & 0 & 4921 & 0 & 0 & 4921 & 0 & 4921 \\
        0 & 4920 & 0 & 4921 & 4921 & 0 & 4921 & 0
        \end{bmatrix}
        \]
        故由
        \[
        A^9
        \begin{bmatrix}
        1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0
        \end{bmatrix}
        =
        \begin{bmatrix}
        0 \\ 4921 \\ 0 \\ 4921 \\ 4921 \\ 0 \\ 4920 \\ 0
        \end{bmatrix}
        \]
        可知$A \to G$ 有 $4920$ 种路线。
        \textcolor{red}{(待递推解)}
    \end{solution}

\end{questions}

